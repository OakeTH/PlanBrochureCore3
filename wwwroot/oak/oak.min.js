var oakdef;window.oak=$();window.host=window.location.protocol+"//"+window.location.host+"/";window.SV={Standardfn:"Ajax/Standardfn",StandardfnPost:"Ajax/StandardfnPost",Gridfn:"Ajax/Gridfn",DDLfn:"Ajax/DDLfn",DownloadExcelFromDTfn:"Download/DownloadExcelFromDBfn",DownloadExcelFromJsonfn:"Download/DownloadExcelFromJsonfn",Downloadfilefn:"Download/Downloadfilefn",SharedPages:"PDF/GetHTMPTemplate?templatepath=",DownloadPDFfn:"PDF/DownloadPDF",FilterParamsfn:"Ajax/FilterParamsfn",Uploadfn:"Upload/Uploadfn",Emailingfn:"Email/Emailing",jsonTHF_Path:"JsonFile/thaiaddress.json",OneSignalGetAppID:"OneSignal/GetAppID",DependencyRootPath:"/oak/libraries/",ALIAS:window.myALIAS||"",host:""};oakdef={isBE:!1,ddlheight:300,topicwidth:120,dialogwidth:600,pagesize:10,gridcolumnwidth:120,griddelete_title:"ลบ",griddelete_confirm:"ยืนยัน",griddelete_cancel:"ยกเลิก",gridinserter_buttontext:"เพิ่มข้อมูลใหม่",griddelete_top:-50,griddelete_right:180,griddelete_errormessage:"ลบข้อมูลไม่สำเร็จ",griddelete_dialog_title:"ยืนยันการลบข้อมูล",gridempty_data:"ไม่พบข้อมูล",upload_height:80,upload_maxfile_amount:1,upload_maxfile_size:2e7,upload_placeholder:"คลิ้ก หรือ ลาก ไฟล์ที่ต้องการอัพโหลดมาวางที่นี้",upload_empty:"ไม่พบไฟล์",dropdown_width:190,dialog_effect:"modal-slidedown",dialog_icon:"success",dialog_hideafter:5e3,dialog_position:"bottom-center",excelimport_choose_sheet_msg:"--- เลือก Sheet ที่ต้องการ ---",processingButton_value:"กำลังทำงาน...",processingButton_loadingTime:3e3,processingButton_timeOut:3e4,processingButton_theme:"ILPYellow"};SV.host=window.location.origin+"/"+(SV.ALIAS?SV.ALIAS+"/":"");String.prototype.startsWith||(String.prototype.startsWith=function(n,t){return this.substr(!t||t<0?0:+t,n.length)===n});String.prototype.endsWith||(String.prototype.endsWith=function(n,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-n.length,t)===n});String.prototype.includes||(String.prototype.includes=function(){"use strict";return String.prototype.indexOf.apply(this,arguments)!==-1});Element.prototype.remove||(Element.prototype.remove=function(){this.parentElement.removeChild(this)});Date.prototype.addDays=function(n){var t=new Date(this.valueOf());return t.setDate(t.getDate()+n),t};Array.prototype.distinct=function(){var n=[];return $.each(this,function(t,i){var r=!1;$.each(n,function(n,t){i.id==t.id&&(r=!0)});r==!1&&i.id!=""&&n.push(i)}),n};var oakfn={},substr=function(n,t,i){t=t===""?0:n.indexOf(t)+1;var r=n.indexOf(i,t);return-1<r?n.substring(t,r):n.split(i).pop()},querystr=function(){for(var i=[],n,r=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),t=0;t<r.length;t++)n=r[t].split("="),i[n[0]]=n[1];return i||[]},objtoquerystr=function(n,t){let r="";return $.each(n,function(n,u){if(t){let n=u.toString().split(""),t="";for(i=0;i<n.length;i++)t+=n[i]+" ";u=encodeURIComponent(t)}r+=n+"="+u+"&"}),"?"+r.slice(0,-1)},getDate=function(n,t){let u=oakdef.isBE?543:0,r=n||"/",i;if(t&&(t=parseInt(t)),t>1e6)i=new Date(t);else if(n&&n.length>8){let f,e=n;e.indexOf("/")>-1?(f=e.split("/"),r="/"):e.indexOf("-")>-1>-1?(f=e.split("-"),r="-"):(f=[],f.push(e.substring(0,2)),f.push(e.substring(2,2)),f.push(e.substring(4,2)));f[2]=f[2].substring(0,4);i=new Date(f[2],f[1]-1,f[0]);t&&i.setDate(i.getDate()+t);u=0}else t?(i=new Date,i.setDate(i.getDate()+t)):i=new Date;let f=i.getFullYear()+u,e=i.getMonth()+1,o=i.getDate(),s=add0(o,2)+r+add0(e,2)+r+f;return{fulldate:s,date:o,month:e,year:f}},dateDiff=function(n,t){return!n||!t?null:(n=n.split("/"),t=t.split("/"),cDate1=new Date(n[2]+"-"+n[1]+"-"+n[0]),cDate2=new Date(t[2]+"-"+t[1]+"-"+t[0]),cDate1=Date.UTC(cDate1.getFullYear(),cDate1.getMonth(),cDate1.getDate()),cDate2=Date.UTC(cDate2.getFullYear(),cDate2.getMonth(),cDate2.getDate()),Math.floor((cDate2-cDate1)/864e5))},addcomma=function(n){return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},add0=function(n,t){return n=n.toString(),n.length<t?add0("0"+n,t):n},randomstring=function(){return Math.random().toString(36).split(".")[1]+Math.random().toString(36).split(".")[1]},toFileSizeFormat=function(n){return n<1e3?n+" B":n<1e6?Math.round(n/1e3)+" KB":Math.round(n/1e6)+" MB"},isEmail=function(n){if(!n)return!1;return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(n).toLowerCase())};$.fn.window=function(n,t){t=t||"input,label,select,span,div";$(n).find(t).addBack().each(function(){if(!this.id)return!0;window[this.id]=$(this);this.type&&this.type==="date"&&window[this.id].datebox({startview:this.dataset.startview})})};$.fn.scrollTo=function(n){n||(n={});var t=n.paddingtop||0,i=n.duration||1e3,r=n.top||0;$("html, body").animate({scrollTop:$(this).offset().top+t-r},i)};$.fn.ajaxpost=function(n){let t=null,r=SV.host,u="json",i=!1,f=!1,e=null;if(n.ajaxconfig&&(u=n.ajaxconfig.datatype!==undefined?n.ajaxconfig.datatype:u,f=n.ajaxconfig.processdata!==undefined?n.ajaxconfig.processdata:f,i=n.ajaxconfig.contenttype!==undefined?n.ajaxconfig.contenttype:i,e=n.ajaxconfig.header!==undefined?n.ajaxconfig.header:e,delete n.ajaxconfig),i=="application/json")t={},$.each(n,function(n,i){n!="url"&&typeof i!="function"&&(t[n]=i)}),t=JSON.stringify(t);else{let i=Object.keys(n);for(N=0;N<i.length;N++)n[i[N]]instanceof FormData&&(t=n[i[N]]);t||(t=new FormData);$.each(n,function(n,i){if(i===undefined)return!0;n!="url"&&typeof i!="function"?t.append(n,typeof i=="object"?JSON.stringify(i):i):n=="url"&&i.indexOf("/")==-1&&t.append(n,typeof i=="object"?JSON.stringify(i):i)})}if(n.url&&(usecustomurl=n.url.indexOf("/")===-1?!1:!0),usecustomurl?n.url.startsWith("http")?(r=n.url,n.url.startsWith(window.host)||(u=!1,i=!1)):r+=n.url:r+=n.Emailingfn?SV.Emailingfn:SV.StandardfnPost,n.onsuccess||n.onerror)$.ajax({type:"POST",url:r,data:t,headers:e,contentType:i,processData:f,dataType:u,success:function(t){n.onsuccess&&n.onsuccess(t)},error:function(t,i,r){n.onerror&&n.onerror(t,i,r)}});else return new Promise(function(n){n($.ajax({type:"POST",url:r,data:t,headers:e,contentType:i,processData:f}))})};$.fn.ajaxpost.redirect=function(n,t){n.url.startsWith("http")||(n.url=SV.host+n.url);var i=$("<form><\/form>").attr("action",n.url).attr("target",t?"_blank":"").attr("method","post");$.each(n,function(n,t){if(typeof t=="object"&&(t=JSON.stringify(t)),typeof t=="function")return!0;n!=="url"&&$("<input />",{type:"hidden",name:n,value:t}).appendTo(i)});let r=function(){return new Promise(function(n){n(i.appendTo("body").submit().remove())})};r().then(function(){n.onsuccess&&n.onsuccess()})};$.fn.ajaxpost.redirect.newpage=function(n){oak.ajaxpost.redirect(n,!0)};$.fn.ajaxget=function(n){var t=SV.host,i="json",r=!1,e=!1,f=null,u;if(n.url&&(usecustomurl=n.url.indexOf("/")===-1?!1:!0),usecustomurl?(n.url.startsWith("http")?(t=n.url,n.url.startsWith(window.host)||(i=!1,r=!1)):t+=n.url,delete n.url):(t+=n.Gridfn?SV.Gridfn:n.DDLfn?SV.DDLfn:n.FilterParamsfn?SV.FilterParamsfn:n.Emailingfn?SV.Emailingfn:SV.Standardfn,$.each(SV,function(t){delete n[t]})),n.ajaxconfig&&(i=n.ajaxconfig.datatype!==undefined?n.ajaxconfig.datatype:i,e=n.ajaxconfig.processdata!==undefined?n.ajaxconfig.processdata:e,r=n.ajaxconfig.contenttype!==undefined?n.ajaxconfig.contenttype:r,f=n.ajaxconfig.header!==undefined?n.ajaxconfig.header:f,delete n.ajaxconfig),u={},$.each(n,function(n,t){typeof t!="function"&&(u[n]=t)}),n.async===!1){if(delete n.async,b=$.ajax({type:"GET",contentType:r,data:usecustomurl?u:{Keys:JSON.stringify(n)},url:t,dataType:i,async:!1}),b.responseJSON)return b.responseJSON}else if(n.onsuccess||n.onerror)$.ajax({type:"GET",contentType:r,data:usecustomurl?u:{Keys:JSON.stringify(n)},url:t,dataType:i,headers:f,success:function(t){n.onsuccess&&n.onsuccess(t)},error:function(t,i,r){n.onerror&&n.onerror(t,i,r)}});else return new Promise(function(e){e($.ajax({type:"GET",contentType:r,data:usecustomurl?u:{Keys:JSON.stringify(n)},url:t,dataType:i,headers:f}))})};$.fn.ajaxget.redirect=function(n){var t=Object.keys(n);for(querystring={},i=0;i<t.length;i++)t[i]!=="url"&&(querystring[t[i]]=n[t[i]]);querystring=$.isEmptyObject(querystring)?"":objtoquerystr(querystring);window.location.href=n.url.startsWith("http")?n.url+querystring:SV.host+n.url+querystring};$.fn.ajaxget.redirect.newpage=function(n){var i=n.url.startsWith("http")?n.url:SV.host+n.url,t="";n.querystring&&(t=objtoquerystr(n.querystring));window.open(i+t,"_blank")};$.fn.dropdown=function(n){return n||(n={}),n.me=this,oak.dropdown.get_source(n.source,n.me[0]).then(function(t){n.source=t;n.me.dropdown.then(n)}),this};oak.dropdown.source=[];oak.dropdown.get_source=function(n,t){return new Promise(function(r){if(n===undefined)r(undefined);else if(n==="thai address")oak.dropdown.thaiaddress?r():r($.getJSON(SV.host+SV.DependencyRootPath+SV.jsonTHF_Path,function(n){oak.dropdown.thaiaddress=n}));else if(n.url){let i=n.onsuccess||$.noop;n.DDLfn=!0;n.onsuccess=function(n){i(n);oak.dropdown.add_select_options(n,t);r(n)};oak.ajaxget(n)}else if(n==="myoptions"){for(n=[],i=0;i<t.options.length;i++)n.push({value:t.options[i].value,text:t.options[i].innerHTML});r(n)}else oak.dropdown.add_select_options(n,t),r(n)})};oak.dropdown.add_select_options=function(n,t){if((n||n.length)&&t.tagName!=="INPUT"){for(i=t.options.length-1;i>=0;i--)t.remove(i);if(n[0].constructor.name!=="Object")for(i=0;i<n.length;i++){let r=document.createElement("option");r.value=n[i].value===undefined?n[i]:n[i].value;r.innerHTML=n[i].text===undefined?n[i]:n[i].text;t.add(r)}else{let r=Object.keys(n[0])[0],u=Object.keys(n[0])[1]||r;for(i=0;i<n.length;i++){let f=document.createElement("option");f.value=n[i][r];f.innerHTML=n[i][u];t.add(f)}}}};oak.dropdown.get_source_objectname=function(n){if(n.source.length){if(n.source[0].constructor!==Object)for(i=0;i<n.source.length;i++)n.source[i]={firstkey:n.source[i],secondkey:n.source[i]};let t=n.me[0].id;if(firstkey=Object.keys(n.source[0])[0],secondkey=Object.keys(n.source[0])[1]||firstkey,oak.dropdown.source[t].objectname={firstkey:firstkey,secondkey:secondkey,groupBy:null,uniqueGroup:[]},n.groupby){var r=n.source.map(function(t){return t[n.groupby]}),u=r.filter(function(n,t,i){return i.indexOf(n)===t});oak.dropdown.source[t].objectname.groupBy=n.groupby;oak.dropdown.source[t].objectname.uniqueGroup=u}}};oak.dropdown.then=function(n){if(n.province||n.zipcode)return oak.dropdown.addressbox||oak.ajaxget({url:SV.host+"oak/oak.address_box.min.js",async:!1,ajaxconfig:{datatype:"script"}}),n.me.dropdown.addressbox(n),n.me;isNaN(n.width)||(n.width+="px");n.height||(n.height=oakdef.ddlheight);isNaN(n.height)||(n.height+="px");n.placeholder||(n.placeholder=n.me[0].placeholder||"");n.elementtype=n.me[0].tagName==="INPUT"?"textbox":"dropdown";n.minlength||(n.minlength=0);n.required=n.required||n.me[0].required?!0:!1;n.onselected||(n.onselected=null);n.fixposition||(n.fixposition=!1);n.flexdisplay||(n.flexdisplay=!1);n.showsearchbox===undefined&&(n.showsearchbox=!0);n.me.dropdown.core(n)};oak.dropdown.core=function(n){let t=function(){if(this.me=n.me,this.id=n.me[0].id,this.height=n.height,this.width=n.width,this.onselected=n.onselected,this.placeholder=n.placeholder,this.value=n.value,this.elementtype=n.elementtype,this.minlength=n.minlength,this.required=n.required,this.fixposition=n.fixposition,this.flexdisplay=n.flexdisplay,this.showsearchbox=n.showsearchbox,this.options_ddl_mtop="1cm",this.options_autoc_mtop="0px",n.source){if(this.options_ul_clear(),!this.id){let n=Math.random().toString(36).substring(2);this.me[0].id=n;this.id=n}oak.dropdown.source[this.id]={};oak.dropdown.source[this.id].data=n.source;oak.dropdown.get_source_objectname(n)}this.elementtype!=="dropdown"||this.me.refer("is_created")?this.elementtype!=="textbox"||this.me.refer("is_created")||(this.options_ul=this.options_ul_create(),this.me.after(this.options_ul),this.txt_tags_add(),this.me.refer("is_created",!0)):(this.options_ul=this.options_ul_create(),this.searchbox=this.searchbox_create(),this.me.after(this.options_ul),this.showsearchbox&&this.me.after(this.searchbox),this.ddl_tags_add(),this.me.refer("is_created",!0));this.value&&(this.me.val(this.value).trigger("change"),this.me[0].text=this.me[0].options[this.me[0].selectedIndex].innerHTML);this.placeholder_create()};t.prototype={input_width:function(){return this.width||this.me.outerWidth()||oakdef.dropdown_width},searchbox_keyup:function(){if(oak.dropdown.ul_items_create({ul:this.my_options_ul,owner_id:this.owner_id,filtertext:this.value}),this.my_options_ul.childNodes.length==1){let t=this.my_options_ul.childNodes[0],n=document.createEvent("MouseEvents");n.initEvent("mousedown",!0,!0);t.dispatchEvent(n)}},searchbox_click:function(){this.classList.remove("hide");this.my_options_ul.classList.remove("hide");this.my_options_ul.children.length===0&&oak.dropdown.ul_items_create({ul:this.my_options_ul,owner_id:this.owner_id})},searchbox_create:function(){let t=n.fixposition?" fix":"";return $('<input type="search">').addClass("oak-ddl-searchbox hide"+t).css("width",this.input_width()).attr("placeholder","Search").refer("owner_id",this.id).refer("fixposition",this.fixposition).refer("flexdisplay",this.flexdisplay).refer("my_options_ul",this.options_ul).referTo("my_searchbox",this.options_ul).on("keyup",this.searchbox_keyup).on("click",this.searchbox_click).on("focusout",function(){this.classList.add("hide");this.my_options_ul.classList.add("hide")})},options_ul_create:function(){let n=$("<ul>").refer("elementtype",this.elementtype).refer("showsearchbox",this.showsearchbox).on("focusout",function(){this.classList.add("hide")});return this.options_ul_style(n),n},options_ul_style:function(t){let i=this.elementtype==="dropdown"&&n.showsearchbox?this.options_ddl_mtop:this.options_autoc_mtop,r=this.elementtype==="dropdown"&&n.showsearchbox?"show":"",u=n.fixposition?" fix":"";t.css("width",this.input_width()).css("max-height",this.height).css("margin-top",i).addClass("oak-ddl-options hide"+u).addClass(r)},options_ul_clear:function(){let n=this.me.refer("my_options_ul");if(n)while(n.firstChild)n.removeChild(n.firstChild)},ddl_click:function(n){if(n.button==2){var t=document.createElement("input");t.type="text";t.value=this.options[this.selectedIndex].innerHTML;document.body.appendChild(t);t.select();document.execCommand("copy");document.body.removeChild(t);oak.minidialog("คัดลอกข้อความ");n.preventDefault()}else{let t=this.my_searchbox,i=this.getBoundingClientRect(),r=0;t.fixposition||(r=window.pageYOffset||document.documentElement.scrollTop);t.flexdisplay||(t.style.left=i.left+"px",t.style.top=i.top+i.height+r+"px",t.my_options_ul.style.left=i.left+"px",t.my_options_ul.style.top=i.top+i.height+r+"px");t.my_options_ul.classList.remove("hide");t.classList.remove("hide");t.click();this.my_options_ul.showsearchbox?t.focus():$(this.my_options_ul).attr("tabindex",-1).focus();n.preventDefault()}},ddl_tags_add:function(){this.me.refer("text","").refer("options_ddl_mtop",this.options_ddl_mtop).refer("my_options_ul",this.options_ul).refer("my_searchbox",this.searchbox).referTo("my_input",this.options_ul).on("mousedown",this.ddl_click);this.me[0].required=this.required},txt_keyup:function(n){if(!(this.value.length<this.minlength)&&(this.my_options_ul.classList.remove("hide"),oak.dropdown.ul_items_create({ul:this.my_options_ul,owner_id:this.id,filtertext:this.value}),this.my_options_ul.childNodes.length==1&&n.keyCode!=8)){let t=this.my_options_ul.childNodes[0],n=document.createEvent("MouseEvents");n.initEvent("mousedown",!0,!0);t.dispatchEvent(n)}},txt_click:function(n){if(n.button==2)return this.select(),!1;let i=0,t=this.getBoundingClientRect();(this.fixposition||(i=window.pageYOffset||document.documentElement.scrollTop),this.my_options_ul.style.left=t.left+"px",this.my_options_ul.style.top=t.top+t.height+i+"px",this.value.length<this.minlength)||(this.my_options_ul.classList.remove("hide"),oak.dropdown.ul_items_create({ul:this.my_options_ul,owner_id:this.id,filtertext:this.value}))},txt_tags_add:function(){this.me.refer("my_options_ul",this.options_ul).refer("minlength",this.minlength).refer("onselected",this.onselected).referTo("my_input",this.options_ul).attr("placeholder",this.placeholder).attr("autocomplete","off").on("keyup",this.txt_keyup).on("mousedown",this.txt_click).on("focusout",function(){this.my_options_ul.classList.add("hide")})},placeholder_create:function(){if(this.placeholder)if(this.elementtype==="dropdown"){let i=this.me[0].options.length-1,t=this.me[0].options[i];t&&t.disabled&&this.me[0].remove(t);let n=document.createElement("option");n.innerHTML=this.placeholder;n.value="";n.disabled=!0;this.me[0].add(n);(this.placeholder||this.value==="")&&(this.me[0].value="",this.me[0].text="")}else this.me[0].placeholder=this.placeholder}};new t};oak.dropdown.apply_value_to_owner=function(){let n=this.parentNode.my_input,t=this.parentNode.elementtype;if(n.onselected)n.onselected({oldvalue:n.value,newvalue:this.innerText});if(t==="textbox"){let t=n.value;n.value=this.innerText;n.dataset.myvalue=this.firstkey;n.my_options_ul.classList.add("hide");n.value!=t&&$(n).trigger("change");n.blur()}else{let n=this.parentNode,t=n.my_input.value;n.classList.add("hide");n.my_searchbox.classList.add("hide");n.my_input.value=this.firstkey;n.my_input.text=this.innerHTML;t!=this.firstkey&&$(n.my_input).trigger("change")}};oak.dropdown.ul_items_create=function(n){let r=oak.dropdown.source[n.owner_id].data;if(r.length){let t=oak.dropdown.source[n.owner_id].objectname;for(n.filtertext&&(r=oak.dropdown.filter_data(r,n.filtertext,t.secondkey));n.ul.firstChild;)n.ul.removeChild(n.ul.firstChild);if(r.length)if(t.groupBy)for(i=0;i<t.uniqueGroup.length;i++){var f=t.uniqueGroup[i],u=oak.dropdown.filter_data(r,f,t.groupBy);if(u.length!==0){let e=document.createElement("li");for(e.innerHTML=f,e.firstkey=f,e.classList.add("group-topic"),e.addEventListener("mousedown",function(n){n.preventDefault()}),n.ul.appendChild(e),ii=0;ii<u.length;ii++){let i=document.createElement("li");i.innerHTML=u[ii][t.secondkey];i.firstkey=u[ii][t.firstkey];i.addEventListener("mousedown",oak.dropdown.apply_value_to_owner);i.classList.add("pl-4");n.ul.appendChild(i)}}}else for(i=0;i<r.length;i++){let u=document.createElement("li");u.innerHTML=r[i][t.secondkey];u.firstkey=r[i][t.firstkey];u.addEventListener("mousedown",oak.dropdown.apply_value_to_owner);n.ul.appendChild(u)}}};oak.dropdown.filter_data=function(n,t,i){return n[0][i].constructor===Number?n.filter(function(n){return n[i]==t}):n.filter(function(n){return n[i].indexOf(t)>-1})};$.fn.downloadexcel=function(n){n.Source_SP=JSON.stringify(n.source);n.excelsheetsname&&n.excelsheetsname instanceof Array&&(n.excelsheetsname+="");n.lastrowissummary&&n.lastrowissummary instanceof Array&&(n.lastrowissummary+="");window.location.href=SV.host+SV.DownloadExcelFromDTfn+objtoquerystr(n)};$.fn.downloadfile=function(n){oak.minidialog({value:"กำลังค้นหาไฟล์... "});var t={};t.source=JSON.stringify(n.source);t.downloadfrom=n.downloadfrom;t.containername=n.containername||"";window.location.href=SV.host+SV.Downloadfilefn+objtoquerystr(t)};oak.pdftemplate=SV.host+"PDF/GetHTMPTemplate?templatepath=";$.fn.minidialog=function(n){$.toast||oak.ajaxget({url:SV.host+SV.DependencyRootPath+"Toast/jquery.toast.min.js",async:!1,ajaxconfig:{datatype:"script"}});oak.minidialog.then(n)};oak.minidialog.then=function(n){if(n===!1)return $.toast().reset("all");if(!n)return!1;let t=[],r=0;for(n.constructor===Array?t=n:t.push(n),i=0;i<t.length;i++)(typeof t[i]!="object"&&(t[i]={value:t[i]}),t[i].value!==undefined&&t[i].value.constructor!==Boolean)&&(t[i].bgcolor||(t[i].bgcolor=null),t[i].icon===undefined&&(t[i].icon=oakdef.dialog_icon),t[i].hideafter||(t[i].hideafter=oakdef.dialog_hideafter),t[i].position||(t[i].position=oakdef.dialog_position),t[i].showhidetransition||(t[i].showhidetransition="slide"),t[i].allowtoastclose===undefined&&(t[i].allowtoastclose=!0),t[i].delay?t[i].delay+=r:t[i].delay=r,r+=500,oak.minidialog.core(t[i]))};oak.minidialog.core=function(n){window.setTimeout(function(){$.toast({text:n.value,icon:n.icon,bgColor:n.bgcolor,hideAfter:n.hideafter,showHideTransition:n.showhidetransition,allowToastClose:n.allowtoastclose,position:n.position,loader:!0})},n.delay)};oak.minidialog.reset=function(){return $.toast().reset("all")};$.gridSetup=function(n){oakdef.gridSetup={};$.extend(oakdef.gridSetup,n)};$.fn.grid=function(n){if(oak.jsGrid||oak.ajaxget({url:SV.host+SV.DependencyRootPath+"JsGrid/jsgrid.oak.min.js",async:!1,ajaxconfig:{datatype:"script"}}),oakdef.gridSetup){var t={};return $.extend(!0,t,oakdef.gridSetup,n),n=t,this.grid_then(n)}return this.grid_then(n)};$.fn.grid_then=function(n){var u=this[0].id,t={},r={},s=[],o,f,e;if(n.fields||(n.fields=[]),n.fieldsADJ||(n.fieldsADJ=[]),n.source)n.source.url?(n.source.async=!1,n.source.Gridfn=1,t=oak.ajaxget(con.source)):n.source&&n.source.Schema&&n.source.Data?(t.Scheme=n.source.Schema,t.Data=n.source.Data):n.source&&!t.Data&&(n.source.table?n.source=n.source.table:n.source instanceof Object&&!(n.source instanceof Array)&&(o=[],o.push(n.source),n.source=o),f=0,e=0,t={},t.Scheme=[],t.Scheme[0]={},t.Data=[],$.each(n.source[0],function(n){t.Scheme[0][f]=n;f+=1}),f=0,$.each(n.source,function(i){e=0;t.Data[i]={};$.each(n.source[i],function(n,r){t.Data[i][e]=r;e+=1})}));else return oak.minidialog(oak.minidialog({icon:"error",value:"ไม่พบ Data Source"})),!1;if(!t||!t.Data||!t.Scheme.length||!t.Data.length&&!t.Scheme.length)return!1;$.isEmptyObject(t.Scheme[0])?n.onemptydata&&n.onemptydata(this[0],n):this[0].style.display="";let h=function(n,i){return-1<n.indexOf(",chk")?"checkbox":-1<n.indexOf(",num")?"number":-1<n.indexOf(",date")?"date":typeof t.Data[0][i]=="number"?"number":"text"},c=function(n,t){return-1<n.indexOf(",w")?substr(n,",w",",").replace("w",""):-1<n.indexOf(",chk")?"80":t?t:oakdef.gridcolumnwidth},l=function(n){return-1<n.indexOf(",center")?"center":-1<n.indexOf(",chk")?"center":-1<n.indexOf(",right")?"right":"left"},a=function(n){if(-1<n.indexOf(",."))return substr(n,",.",",").replace(".","")},v=function(){var r,t;for(i=0;i<n.fieldsADJ.length;i++)for(r=n.fieldsADJ[i],ii=0;ii<n.fields.length;ii++)t=n.fields[ii],r.title==t.fieldname&&((t.hide||t.forhide)&&(t.forhide=!0,t.css="hide",t.headercss="hide"),t.align&&t.align!=="left"&&(t.css?t.css+=" ":t.css="",t.align=="center"?t.css+="jus-center":t.align=="right"&&(t.css+="jus-end")),$.extend(r,t))};return $.each(t.Scheme[0],function(t,i){var r={},u=i.split("^")[1]||i,f;r.name=t;r.title=i.split("^")[0];r.forupdate=u.indexOf(",update")>-1?!0:!1;r.forinsert=u.indexOf(",insert")>-1?!0:!1;r.forhide=u.indexOf(",hide")>-1?!0:!1;r.forread=u.indexOf(",read")>-1?!0:!1;r.required=u.indexOf(",required")>-1?!0:!1;r.filter=u.indexOf(",filter")>-1?!0:!1;r.topics=i.indexOf(",#")>-1?substr(i,",#",",").replace("#",""):r.title;i.toLowerCase()==="id"&&(r.forhide=!0,r.css="hide",r.headercss="hide");i.indexOf(",hide")>-1&&(r.forhide=!0,r.css="hide",r.headercss="hide");i.indexOf(",filter")>-1&&s.push(r);r.type=h(i,t);r.width=c(i,n.defaulfeildwidth);f=l(i);f&&f!=="left"&&(field.css?field.css+=" ":field.css="",field.align=="center"?field.css+="jus-center":field.align=="right"&&(field.css+="jus-end"));i.indexOf(",.")>-1&&(r.css=a(i),r.headercss="");n.fieldsADJ.push(r)}),v(n.fields),r.paging=n.paging===undefined?!0:n.paging,r.excelbutton=n.excelbutton===undefined?!0:n.excelbutton,r.primaryKey=n.primarykey||null,r.fields=n.fieldsADJ,r.pageSize=n.pagesize||oakdef.pagesize,r.pageIndex=1,n.updater&&(oak.grid_update({config:r,updater:n.updater,grid:this[0]}),r.rowClick=function(n){if(n.event.target.type=="button"||n.event.target.tagName=="A"||n.event.target.tagName=="BUTTON")return!1;this.referFn.thisrow=n.event.target.parentElement;let t=this.getcolumnname(n.item);n.fields=this.fields;this.referFn.rowclick(t,n)}),n.inserter&&oak.grid_inserter({config:r,inserter:n.inserter,grid:this[0]}),n.remover&&oak.grid_remover({config:r,remover:n.remover}),n.onrowclick&&(r.rowClick=function(t){if(t.event.target.tagName!=="INPUT"&&t.event.target.tagName!=="BUTTON"&&t.event.target.tagName!=="A"){t.data=this.getcolumnname(t.item);n.onrowclick(t)}}),r.getcolumnname=function(n){let t={};for(i=0;i<this.fields.length;i++){let r=this.fields[i].title;r&&(t[r]=n[i])}return t},r.controller=oak.grid.gridcontroller,r.controller.id=u,jsGrid.oakfn||(jsGrid.oakfn={}),jsGrid.oakfn[u]={},jsGrid.oakfn[u].data=t.Data,jsGrid.oakfn[u].fields=r.fields,jsGrid.oakfn[u].autocomplete=oakfn.set_grid_filter_autocomplete(t.Data,s),jsGrid.oakfn[u].autocomplete_rank=Object.keys(jsGrid.oakfn[u].autocomplete),n.useexternalsearch&&(n.useexternalsearch.getsourcefrom=this[0],r.onHeaderRendered=function(){oak.grid.useExternalSearch(n.useexternalsearch)}),n.hideinternalsearch&&(r.hideInternalSearch=!0),n.theme&&(r.theme=n.theme),n.gridcss&&(r.gridcss=n.gridcss),this.jsGrid(r)};oak.grid_inserter=function(n){let t=function(){this.userconf=n.inserter;this.gridconf=n.config;this.grid=n.grid;this.topicwidth=this.userconf.topicwidth||oakdef.topicwidth;this.dialogwidth=this.userconf.dialogwidth||oakdef.dialogwidth;this.addRefer();this.splitColumnsPerType();this.btnopen=this.createBtnOpen();this.construction()};t.prototype={addRefer:function(){this.referFn={};this.referFn.inputfileds=[];this.referFn.openDialog=this.openDialog;this.referFn.userconf=this.userconf;this.referFn.checkRequiredInputs=this.checkRequiredInputs;this.referFn.createErrorMsg=this.createErrorMsg;this.referFn.grid=this.grid;this.referFn.fields=this.gridconf.fields},createBtnOpen:function(){let n;this.userconf.inserterbutton?n=oak.pureHtml(this.userconf.inserterbutton):(n=document.createElement("input"),n.type="button",n.value=this.userconf.inserterbuttontext||oakdef.gridinserter_buttontext,n.classList.add("btn-insert-opendialog"),$(n).insertBefore(this.grid));n.referFn=this.referFn;n.addEventListener("click",function(){if(this.referFn.inputfileds&&this.referFn.inputfileds.length)for(i=0;i<this.referFn.inputfileds.length;i++)this.referFn.inputfileds[i].value="";$(this.referFn.dialog).dialog({show:!0,title:"เพิ่มข้อมูล"})})},splitColumnsPerType:function(){let n=this.gridconf.fields.filter(function(n){return n.forinsert===!0});this.columns={insertcols:n}},createDialog:function(){let n=document.createElement("div"),t=this.dialogwidth;return n.style.width=t+"px",n.style.background="#fff",n.classList.add("outline"),this.referFn.dialog=n,n},creatLine:function(){let n=document.createElement("div");return n.classList.add("line"),n.classList.add("txt-2"),n},createTopic:function(n){let t=document.createElement("label");return t.innerHTML=n.title,t.style.width=this.topicwidth+"px",t.classList.add("topic"),t},createTxtediter:function(n,t){let r=document.createElement("input");r.type="search";r.my_data=n;r.classList.add("textbox");let u=[];for(t&&(u=Object.keys(t)),i=0;i<u.length;i++){let n=u[i],f=t[u[i]];n!="field"&&(n==="source"?$(r).dropdown({source:f,width:this.dialogwidth-this.topicwidth-20}):n.startsWith("on")?r.addEventListener(n.replace("on",""),f):n=="css"?r.classList.add(f):r[n]=f)}return r},createDllediter:function(n,t){let i=document.createElement("select");return i.my_data=n,i.classList.add("select-2"),t.width||(i.style.width="100%",t.width=this.dialogwidth-this.topicwidth-20),t.value===undefined&&(t.value=""),t.fixposition=!0,$(i).dropdown(t),i},createChkediter:function(n,t){let r=document.createElement("input");r.type="checkbox";r.my_data=n;r.value=!1;r.text=!1;r.addEventListener("change",function(){this.value=this.checked;this.text=this.checked});let u=[];for(t&&(u=Object.keys(t)),i=0;i<u.length;i++){let n=u[i],f=t[u[i]];n!=="field"&&(n==="value"&&(r.value=f,r.text=f),r[n]=f)}return r},getItemTemplate:function(n){let t=[];return(this.userconf.itemtemplate&&(t=this.userconf.itemtemplate.filter(function(t){return n.name==t.field||n.title==t.field})),t.length||t.push({}),n.required&&(t[0].required=!0),n.type==="checkbox")?this.createChkediter(n,t[0]):t[0].type==="dropdown"?this.createDllediter(n,t[0]):t[0].type!=="dropdown"?this.createTxtediter(n,t[0]):void 0},createBtnsave:function(){let n=document.createElement("input");return n.classList.add("jsgrid-btnSave"),n.classList.add("btn-blue"),n.type="button",n.style.marginTop="20px",n.referFn=this.referFn,n.addEventListener("click",this.onBtnsaveClicked),n.value="บันทึก",n},onBtnsaveClicked:function(){let t={},u=this.referFn.grid,e=this.referFn.dialog,n=this.referFn.fields,r=this.referFn.checkRequiredInputs();if(r.length)return this.referFn.createErrorMsg(r);for(i=0;i<this.referFn.inputfileds.length;i++){let u=this.referFn.inputfileds[i],r=u.my_data;for(r.value=u.value,r.text=u.text===undefined?u.value:u.text,r.text===!0?r.value=!0:r.text===!1&&(r.value=!1),t[r.topics]=r.value,f=0;f<n.length;f++)if(n[f].name===r.name){n[f].value=r.value;n[f].text=r.text;break}}if(this.referFn.labelfileds)for(i=0;i<this.referFn.labelfileds.length;i++){let n=this.referFn.labelfileds[i],r=n.my_data;t[r.topics]=n.innerHTML}if(this.referFn.hidefileds)for(i=0;i<this.referFn.hidefileds.length;i++){let n=this.referFn.hidefileds[i];t[n.topics]=n.value}let o=this.referFn.userconf.onsave;userSaveFn=function(){return new Promise(function(i,r){t.resolve=i;t.reject=r;o(t,n)})};userSaveFn().then(function(r){r=t;let o=[];r?r.constructor===Array?o=r:o.push(r):o.push({});let s=Object.keys(o[0]);for(i=0;i<s.length;i++){let u=s[i];if(typeof t[u]!="function"){if(u.toLowerCase().indexOf("error")>-1)return oak.minidialog(r),!1;for(f=0;f<n.length;f++)if(n[f].title===u||n[f].topics===u){n[f].value=o[0][u];n[f].text=o[0][u];o[0][u]="";break}}}let h={};for(i=0;i<n.length;i++)n[i].text!==undefined&&(h[n[i].name]=n[i].text);let c=$(u);c.jsGrid("insertItem",h);c.find(".jsgrid-grid-body tr:first-child").addClass("rowupdated");$(e).dialog("close");oak.minidialog(r)})},checkRequiredInputs:function(){let n=[];for(i=0;i<this.inputfileds.length;i++)this.inputfileds[i].required&&this.inputfileds[i].value==""&&n.push(this.inputfileds[i]);return n},createErrorMsg:function(n){for(oak.minidialog({icon:"error",value:"กรอกข้อมูลไม่ครบ"}),i=0;i<n.length;i++)n[i].classList.add("input-error");window.setTimeout(function(){for(i=0;i<n.length;i++)n[i].classList.remove("input-error")},9e3)},construction:function(){let n=this.createDialog();for(cl=0;cl<this.columns.insertcols.length;cl++){let t=this.creatLine(),i=this.columns.insertcols[cl],u=this.createTopic(i),r=this.getItemTemplate(i);t.appendChild(u);t.appendChild(r);n.appendChild(t);this.referFn.inputfileds.push(r)}let t=this.createBtnsave();n.appendChild(t)}};new t};oak.grid_update=function(n){let t=function(){this.userconf=n.updater;this.gridconf=n.config;this.grid=n.grid;this.topicwidth=this.userconf.topicwidth||oakdef.topicwidth;this.dialogwidth=this.userconf.dialogwidth||oakdef.dialogwidth;this.addRefer();this.splitColumnsPerType();this.construction()};t.prototype={addRefer:function(){this.referFn={};this.referFn.openDialog=this.openDialog;this.referFn.inputfileds=[];this.referFn.labelfileds=[];this.referFn.hidefileds=[];this.referFn.userconf=this.userconf;this.referFn.rowclick=this.onRowclick;this.referFn.checkRequiredInputs=this.checkRequiredInputs;this.referFn.createErrorMsg=this.createErrorMsg;this.referFn.grid=this.grid;this.gridconf.referFn=this.referFn},onRowclick:function(n,t){var r,u;let i=t.item;for(input=0;input<this.inputfileds.length;input++){let f=this.inputfileds[input].tagName,t=this.inputfileds[input].my_data.name,n=this.inputfileds[input];if(n.my_data.prev_value=i[t],f==="INPUT"&&n.type==="checkbox"&&(n.checked=i[t],n.value=i[t]),f==="INPUT")n.value=i[t];else if(f==="SELECT"){for(r=0;r<n.options.length;r++)if(n.options[r].text===i[t]){n.selectedIndex=r;n.text=i[t];break}u=new Event("change");this.inputfileds[input].dispatchEvent(u)}}for(label=0;label<this.labelfileds.length;label++){let n=this.labelfileds[label].my_data.name;this.labelfileds[label].innerHTML=i[n]}for(hide=0;hide<this.hidefileds.length;hide++){let n=this.hidefileds[hide].name;this.hidefileds[hide].value=i[n]}this.fields=t.fields;this.dialog.dialog({show:!0,title:"แก้ไขข้อมูล"})},splitColumnsPerType:function(){let n=this.gridconf.fields.filter(function(n){return n.forupdate===!0}),t=this.gridconf.fields.filter(function(n){return n.forread===!0}),i=this.gridconf.fields.filter(function(n){return n.forhide===!0});this.columns={updatecols:n,readcols:t,hidecols:i}},createDialog:function(){let n=document.createElement("div"),t=this.dialogwidth;return n.style.width=t+"px",n.style.background="#fff",n.classList.add("outline"),this.referFn.dialog=$(n),n},creatLine:function(){let n=document.createElement("div");return n.classList.add("line"),n.classList.add("txt-2"),n},createTopic:function(n){let t=document.createElement("label");return t.innerHTML=n.title,t.style.width=this.topicwidth+"px",t.classList.add("topic"),t},createTxtediter:function(n,t){let r=document.createElement("input");r.type=t.type||"search";r.my_data=n;r.classList.add("textbox");let u=[];for(t&&(u=Object.keys(t)),i=0;i<u.length;i++){let n=u[i],f=t[u[i]];n!="field"&&(n==="source"?$(r).dropdown({source:f,width:this.dialogwidth-this.topicwidth-20}):n.startsWith("on")?r.addEventListener(n.replace("on",""),f):n=="css"?r.classList.add(f):r[n]=f)}return r},createDllediter:function(n,t){let i=document.createElement("select");return i.my_data=n,i.classList.add("select-2"),t.required&&(i.required=!0),t.width||(i.style.width="100%",t.width=this.dialogwidth-this.topicwidth-20),t.fixposition=!0,$(i).dropdown(t),i},createChkediter:function(n,t){let r=document.createElement("input");r.type="checkbox";r.my_data=n;r.value=!1;r.text=!1;r.addEventListener("change",function(){this.value=this.checked;this.text=this.checked});let u=[];for(t&&(u=Object.keys(t)),i=0;i<u.length;i++){let n=u[i],f=t[u[i]];n!=="field"&&(n==="value"&&(r.value=f,r.text=f),r[n]=f)}return r},createlbl:function(n){let t=document.createElement("label");return t.classList.add("read"),t.my_data=n,t.style.width="100%",t},getItemTemplate:function(n){let t=[];return(this.userconf.itemtemplate&&(t=this.userconf.itemtemplate.filter(function(t){return n.name==t.field||n.title==t.field})),t.length||t.push({}),n.required&&(t[0].required=!0),n.type==="checkbox")?this.createChkediter(n,t[0]):t[0].type==="dropdown"?this.createDllediter(n,t[0]):t[0].type!=="dropdown"?this.createTxtediter(n,t[0]):void 0},createBtnclose:function(){let n=document.createElement("input");return n.classList.add("jsgrid-btnSave"),n.classList.add("btn-blue"),n.type="button",n.referFn=this.referFn,n.addEventListener("click",function(){$(this.referFn.dialog).dialog("close")}),n.value="ปิด",n},createBtnsave:function(){let n=document.createElement("input");return n.classList.add("jsgrid-btnSave"),n.classList.add("btn-blue"),n.type="button",n.referFn=this.referFn,n.addEventListener("click",this.onBtnsaveClicked),n.value="บันทึก",n},onBtnsaveClicked:function(){let t={},u=this.referFn.grid,e=this.referFn.dialog,n=this.referFn.fields,r=this.referFn.checkRequiredInputs();if(r.length)return this.referFn.createErrorMsg(r);for(i=0;i<this.referFn.inputfileds.length;i++){let u=this.referFn.inputfileds[i],r=u.my_data;for(r.value=u.value,r.text=u.text===undefined?u.value:u.text,r.text===!0?r.value=!0:r.text===!1&&(r.value=!1),t[r.topics]=r.value,f=0;f<n.length;f++)if(n[f].name===r.name){n[f].value=r.value;n[f].text=r.text;break}}if(this.referFn.labelfileds)for(i=0;i<this.referFn.labelfileds.length;i++){let n=this.referFn.labelfileds[i],r=n.my_data;t[r.topics]=n.innerHTML}if(this.referFn.hidefileds)for(i=0;i<this.referFn.hidefileds.length;i++){let n=this.referFn.hidefileds[i];t[n.topics]=n.value}let o=this.referFn.thisrow,s=this.referFn.userconf.onsave;userSaveFn=function(){return new Promise(function(i,r){t.resolve=i;t.reject=r;s(t,n)})};userSaveFn().then(function(t){let r=[];t?t.constructor===Array?r=t:r.push(t):r.push({});let s=Object.keys(r[0]);for(i=0;i<s.length;i++){let u=s[i];if(u.toLowerCase().indexOf("error")>-1)return oak.minidialog(t),!1;for(f=0;f<n.length;f++)if(n[f].title===u){n[f].value=r[0][u];n[f].text=r[0][u];break}}let h={};for(i=0;i<n.length;i++)n[i].text!==undefined&&(h[n[i].name]=n[i].text);$(u).jsGrid("updateItem",o,h);$(e).dialog("close")}).catch(function(n){let t=oakdef.dialog_icon;oakdef.dialog_icon="error";oak.minidialog(n);oakdef.dialog_icon=t})},checkRequiredInputs:function(){let n=[];for(i=0;i<this.inputfileds.length;i++)this.inputfileds[i].required&&this.inputfileds[i].value==""&&n.push(this.inputfileds[i]);return n},createErrorMsg:function(n){for(oak.minidialog({icon:"error",value:"กรอกข้อมูลไม่ครบ"}),i=0;i<n.length;i++)n[i].classList.add("input-error");window.setTimeout(function(){for(i=0;i<n.length;i++)n[i].classList.remove("input-error")},9e3)},construction:function(){let n=this.createDialog(),t=this.userconf.onsave?this.createBtnsave():this.createBtnclose();for(cl=0;cl<this.columns.readcols.length;cl++){let t=this.creatLine(),i=this.columns.readcols[cl],u=this.createTopic(i),r=this.createlbl(i);t.appendChild(u);t.appendChild(r);n.appendChild(t);this.referFn.labelfileds.push(r)}for(cl=0;cl<this.columns.updatecols.length;cl++){let t=this.creatLine(),i=this.columns.updatecols[cl],u=this.createTopic(i),r=this.getItemTemplate(i);t.appendChild(u);t.appendChild(r);n.appendChild(t);this.referFn.inputfileds.push(r)}for(cl=0;cl<this.columns.hidecols.length;cl++)this.referFn.hidefileds.push(this.columns.hidecols[cl]);n.appendChild(t)}};new t};oak.grid_remover=function(n){let t=n.config.fields;t[t.length]={type:"control",modeSwitchButton:!0,editButton:!1,width:"50",align:"left"};n.config.onsave_delete=n.remover.onsave};oakfn.set_grid_filter_autocomplete=function(n,t){let i={};return $.each(t,function(t,r){i[r.name]=n.reduce(function(n,t){var i=n.filter(function(n){return t[r.name]===n});return i.length||n.push(t[r.name]),n},[])}),i};oak.grid.gridcontroller={loadData:function(n){return n?(STR="jsGrid.oakfn[this.id].data.filter(function (e) { return ",$.each(n,function(n,t){STR+="number"==typeof t?"e["+n+"] == "+t:"boolean"==typeof t?"e["+n+"] == "+t:"-1 < e["+n+"].indexOf('"+t+"')";STR+=" && "}),STR=STR.slice(0,-4),STR+=" }); ",eval(STR)):jsGrid.oakfn[this.id].data}};oak.grid.useExternalSearch=function(n){var t=function(n){if(n.at=n.at?oak.pureHtml(n.at):this,!n.at===undefined)return!1;if(!n.getsourcefrom)return this;n.linecss||(n.linecss="txt-2");n.fieldcss||(n.fieldcss="");n.subfieldcss||(n.subfieldcss="");n.fieldsperrow||(n.fieldsperrow=2);n.topicminwidth||(n.topicminwidth="120px");this.getFieldsPerRow(n);this.getGridSearchColumn();this.getSource(n);this.renderFields(n)};t.prototype={source:[],gridSearchColumns:[],getSource:function(n){n&&n.getsourcefrom&&(n.getsourcefrom.constructor===Array&&(this.source=Object.keys(n.getsourcefrom[0])),(n.getsourcefrom instanceof HTMLElement||n.getsourcefrom.id)&&(this.source=jsGrid.oakfn[n.getsourcefrom.id].fields),n.fields&&(this.avaliablefields=n.fields))},renderFields:function(n){this.createLine=function(){var t=document.createElement("div");return t.classList.add("row"),$(t).addClass(n.linecss),t};this.createSubLine=function(){var t=document.createElement("div");return $(t).addClass(n.subfieldcss+" bar pr-3"),t};this.createField=function(t){var r=t.type||"text",i=document.createElement("input"),u;return i.classList.add("flex-grow"),i.type=r,i.myGridSearchColumn=this.gridSearchColumns[t.name],i.addEventListener("blur",function(){this.value.length>0?this.myTopic.classList.add("fill"):this.myTopic.classList.remove("fill")}),i.addEventListener("keyup",function(){this.value.length>0?this.myTopic.classList.add("fill"):this.myTopic.classList.remove("fill");this.myGridSearchColumn.value=this.value;$(this.myGridSearchColumn).trigger("input")}),t.filter&&(u=function(){var r=t.name,u=jsGrid.oakfn[n.getsourcefrom.id].data.map(function(n){return n[r]}),f=u.filter(function(n,t,i){return i.indexOf(n)===t});$(i).dropdown({source:f,fixposition:!0,onselected:function(n){this.myGridSearchColumn.value=n.newvalue;$(this.myGridSearchColumn).trigger("input")}})}()),$(i).addClass(n.fieldcss),i};this.createField.addRefer=function(n,t){n.myTopic=t};this.createTopic=function(t){var i=document.createElement("label");return i.innerHTML=t.topics,i.classList.add("oak-searchf-topic"),i.style.minWidth=n.topicminwidth,i};this.build=function(){var r=this.createLine();for(i=0;i<this.source.length;i++)if(!this.source[i].forhide&&(!this.avaliablefields||this.avaliablefields.indexOf(this.source[i].topics)!==-1||this.avaliablefields.indexOf(this.source[i].name)!==-1)){var u=this.createField(this.source[i]),f=this.createTopic(this.source[i]),t=this.createSubLine(i);this.createField.addRefer(u,f);t.appendChild(f);t.appendChild(u);r.appendChild(t)}n.at.appendChild(r)};this.build()},getFieldsPerRow:function(n){n.fieldsperrow===1?n.subfieldcss+=" col-12":n.fieldsperrow===2?n.subfieldcss+=" col-6":n.fieldsperrow===3?n.subfieldcss+=" col-4":n.fieldsperrow===4?n.subfieldcss+=" col-3":n.fieldsperrow===5?n.subfieldcss+=" col-2":n.fieldcss+=" col-1"},getGridSearchColumn:function(){this.gridSearchColumns=$(n.getsourcefrom).find(".jsgrid-filter-row>td>input")}};new t(n)};$.fn.upload=function(n,t){if(oak.upload.core(this[0],n),typeof n=="string")if(n==="uploading")this[0].uploadFn.uploading(t);else if(n==="deletefile")this[0].uploadFn.deleteUploadedFile(t);else if(n==="clear")this[0].uploadFn.clearLayout(),this[0].uploadFn.clearFiles();else if(n==="setfilesinfo")this[0].uploadFn.setfilesinfo(t);else{if(n==="getfilesinfo")return this[0].files;if(n==="getfileschanged")return this[0].uploadFn.getFilesChanged(t)}else typeof n=="object"&&(this[0].uploadFn.createUploader(),this[0].uploadFn.createFilesLayout());return this};oak.upload.core=function(n,t){if(!n.uploadFn){let f=t.onsuccess||$.noop,e=t.onerror||$.noop,o=t.source||"",s=t.accept||null,h={onsuccess:f,onerror:e,source:o},r=oak.pureHtml(t.responseto),c=function(){formData=new FormData;let t=n.myuploadEle.myfiles;for(i=0;i<t.length;i++)formData.append(t[i].name,t[i]);return formData},u=function(t){t.type=t.type?t.type.replace("application/",""):"";let e=t.name.split(".").pop().toLowerCase();e.indexOf("xls")>-1?t.type="Excel":e.indexOf("doc")>-1?t.type="Word":e.indexOf("ppt")>-1?t.type="Power Point":t.type.startsWith("image/")?t.type="Picture":["rar","zip","7z"].indexOf(e)>-1?t.type="Compressed File":t.type||(t.type="N/A");let f=document.createElement("div");f.classList.add("line");let r=null;n.args.readonly||(r=document.createElement("label"),r.innerText="ลบ",r.classList.add("removebtn"),r.myuploadEle=n.myuploadEle,r.onremove=n.uploadFn.onremove,r.filename=t.name,r.me=n,r.addEventListener("click",function(){let t=this,r=function(){t.onremove(n._files[i]).then(function(i){if(i&&i.errormessage)return oak.minidialog({icon:"error",value:i.errormessage});t.parentNode.parentNode.removeChild(t.parentNode);t.myuploadEle.myfiles.length&&(t.myuploadEle.myfiles=t.myuploadEle.myfiles.filter(function(n){return n.name!=t.filename}));n.filesName=n.filesName.filter(function(n){return n!=t.filename});n._files=n._files.filter(function(n){return n.name!=t.filename})})};$(this).confirm({title:"ยืนยันการลบไฟล์",position:{margin_top:-25,margin_left:-130},buttons:[{text:"ลบเลย",css:"btn-red btn-mid-size",onclick:r},{text:"ไม่ลบ",css:"btn-blue btn-mid-size"}]})}));let u=document.createElement("label");u.innerHTML=t.name;u.classList.add("filename");t.allowdownload?(u.classList.add("download"),u.addEventListener("click",function(){let n=this.downloadInfo;if(n.path&&(!n.uploadto||!n.containername)){let t=n.path.indexOf("/"),i=n.path.lastIndexOf("/");n.containername=n.path.substring(0,t);n.uploadto=n.path.substring(t+1,i);n.name=n.path.substring(i+1,n.path.length)}if(!n.uploadto&&!n.name)return{errormessage:'"name" and "uploadto" cannot be empty',error:1};oak.downloadfile({containername:this.downloadInfo.containername,downloadfrom:this.downloadInfo.uploadto+"/"+this.downloadInfo.name})})):(u.style.pointerEvents="none",t.allowdownload=!1);let o=document.createElement("label");o.classList.add("size");o.innerHTML=t.size?toFileSizeFormat(t.size):"";let s=document.createElement("label");s.classList.add("type");s.innerHTML=t.type;f.appendChild(u);f.appendChild(o);f.appendChild(s);n._files&&f.appendChild(r);n.displayfileinfo.append(f);n.args&&n.args.containername&&(t.containername=n.args.containername);n.args&&n.args.uploadto&&(t.uploadto=n.args.uploadto);t.path=t.containername+"/"+t.uploadto+"/"+t.name;n._files&&n._files.push(t);n.filesName&&n.filesName.push(t.name);u.downloadInfo=t},l=function(){let t=document.createElement("div"),i=document.createElement("lable");t.classList.add("bar");t.classList.add("empty");n.args.readonly&&(t.style.justifyContent="inherit");i.innerHTML=oakdef.upload_empty;t.appendChild(i);n.displayfileinfo.append(t);n.isEmptyFile=!0},a=function(t){return n.filesName.filter(function(n){return n===t})},v=function(){let i=t.maxfileamount||oakdef.upload_maxfile_amount,r=t.maxfilesize||oakdef.upload_maxfile_size,n=document.createElement("div");return n.classList.add("discription"),n.innerHTML="อัพโหลดได้ "+i+" ไฟล์ | ไฟล์ละไม่เกิน "+toFileSizeFormat(r),n};n.uploadFn={};n.onchange=t.onchange||$.noop;n.uploadFn.createFilesLayout=function(){if(!r){r=document.createElement("div");let t=n.args.width||n.getBoundingClientRect().width;r.style.width=t+"px";r.style.marginTop="2px";$(r).insertAfter(n)}r.classList.add("upload-filesLayout");r.classList.add("bar");n.displayfileinfo=r;n.tagName==="DIV"?(t.width?(isNaN(t.width)||(t.width+="px"),n.style.width=t.width,n.displayfileinfo.style.width=t.width):t.width="100%",t.height?(isNaN(t.height)||(t.height+="px"),n.style.height=t.height):n.style.height=oakdef.upload_height+"px"):n.displayfileinfo.style.display="none"};n.uploadFn.createUploader=function(){if(n.args=t,!n.fnAlreadyExists){if(n.args.readonly){n.style.display="none";return}let i=document.createElement("input");i.type="file";i.accept=s;i.myfunction=h;i.myfiles=[];i.maxFilesAmount=n.args.maxfileamount||oakdef.upload_maxfile_amount;i.maxFilesSize=n.args.maxfilesize||oakdef.upload_maxfile_size;i.addEventListener("change",function(){if(!this.value)return this.value="",oak.minidialog({icon:"error",value:"ไม่สามารถเข้าถึงไฟล์ดังกล่าว"});n.onchange(this);if(n.tagName!=="DIV"){this.value="";return}if(a(this.files[0].name).length)return this.value="",oak.minidialog({icon:"error",value:"ไม่สามารถอัพโหลดไฟล์ชื่อซ้ำกัน"});if(this.myfiles.length>=this.maxFilesAmount)return this.value="",oak.minidialog({icon:"error",value:"อัพโหลดได้สูงสุดไม่เกิน "+this.maxFilesAmount+" ไฟล์"});if(this.files[0].size>this.maxFilesSize)return this.value="",oak.minidialog({icon:"error",value:"ขนาดไฟล์ห้ามเกิน "+toFileSizeFormat(this.maxFilesSize)});n.isEmptyFile&&(n.displayfileinfo.innerHTML="",n.isEmptyFile=!1);this.myfiles.push(this.files[0]);u({name:this.files[0].name,size:this.files[0].size,type:this.files[0].type});this.value=""});i.style.display="none";n.myuploadEle=i;n.tagName==="DIV"&&n.classList.add("uploadinput");n.tagName==="DIV"&&n.classList.add("bar-item");n.addEventListener("click",function(){this.myuploadEle.click()});n.tagName==="DIV"&&(n.innerHTML=n.args.placeholder||oakdef.upload_placeholder);n._files=[];n.filesName=[];n.filesAsStart=[];n.filesNameAsStart=[];n.filesChange=[];n.fnAlreadyExists=!0;n.tagName==="DIV"&&n.appendChild(v());let r=function(n){this.classList.add("uploadinput-dragover");n.preventDefault()},f=function(n){n.preventDefault()},e=function(n){this.classList.remove("uploadinput-dragover");n.preventDefault()},o=function(n){this.classList.remove("uploadinput-dragover");n.dataTransfer.files[0]?(this.myuploadEle.myfiles.push(n.dataTransfer.files[0]),u({name:n.dataTransfer.files[0].name,size:n.dataTransfer.files[0].size,type:n.dataTransfer.files[0].type})):oak.minidialog({icon:"error",value:"ไม่สามารถเข้าถึงไฟล์ได้"});n.preventDefault()};n.addEventListener("dragleave",e);n.addEventListener("dragover",r);n.addEventListener("dragenter",f);n.addEventListener("drop",o);n.parentNode.insertBefore(i,n.nextSibling)}};n.uploadFn.clearLayout=function(){n.displayfileinfo.innerHTML=""};n.uploadFn.clearFiles=function(){n.myuploadEle&&(n.myuploadEle.myfiles=[],n.filesName=[],n._files=[])};n.uploadFn.uploading=function(t){let r={},u=n.args.onuploaded||t.onuploaded,f=function(){let t=n.uploadFn.getFilesChanged().deletedfiles;return $.map(t,function(n){return n.path})};if(r.url=WEBAPI.host+WEBAPI.Uploadfn,r.files=c(),r.deletefiles=f()||[],r.uploadto=n.args.uploadto||t.uploadto,r.containername=n.args.containername||t.containername,r.server=n.args.server||t.server||"",r.onsuccess=function(t){if(t.success){let i=$.extend(n.uploadFn.getFilesChanged(),t);u(i);n.uploadFn.setfilesinfo({source:i.currentfiles,allowdownload:!0})}},r.onerror=n.args.onuploadfailed||t.onuploadfailed,n.myuploadEle.myfiles.length===0&&r.deletefiles.length===0)return u($.extend(n.uploadFn.getFilesChanged(),{filesnotchanged:!0}));if(t.uploadto||t.containername)for(i=0;i<n._files.length;i++)n._files[i].containername=t.containername,n._files[i].uploadto=t.uploadto,n._files[i].path=n._files[i].containername+"/"+n._files[i].uploadto+"/"+n._files[i].name;oak.ajaxpost(r)};n.uploadFn.setfilesinfo=function(t){n.uploadFn.clearLayout();n.uploadFn.clearFiles();let r=t.source;if(n.filesAsStart=[],n.filesNameAsStart=[],r&&r.length)for(i=0;i<r.length;i++){let f=r[i];if(f.path){if(f.path&&(!f.containername||!f.uploadto)){let n=f.path.indexOf("/"),t=f.path.lastIndexOf("/");f.containername=f.path.substring(0,n);f.uploadto=f.path.substring(n+1,t);f.name=f.path.substring(t+1,f.path.length)}}else f.path=f.containername+"/"+f.uploadto+"/"+f.name;n.filesNameAsStart.push(f.name);n.filesAsStart.push(f);f.allowdownload=t.allowdownload;u(f)}else l()};n.uploadFn.onremove=function(t){let i={};return i.onremoved=n.args.onremoved||$.noop,i.onremovefaild=n.args.onremovefaild||$.noop,i.onremoving=function(){return new Promise(function(i){let r=n.args.onremoving||function(n){return n};i(r(t))})},new Promise(function(n){i.onremoving(t).then(function(t){n(i.onremoved(t))}).catch(function(t){n(i.onremovefaild(t))})})};n.uploadFn.deleteUploadedFile=function(t){let r={};if(r.url=WEBAPI.host+WEBAPI.Uploadfn,r.deletepath=n.args.deletepath||t.deletepath,r.containername=n.args.containername||t.containername,r.onsuccess=function(i){(n.args.ondeleted||t.ondeleted)(i)},oak.ajaxpost(r),t.uploadto||t.containername)for(i=0;i<n._files.length;i++){let r=n._files[i];r.containername=t.containername;r.uploadto=t.uploadto;r.path=r.containername+"/"+r.uploadto+"/"+r.name}};n.uploadFn.getFilesChanged=function(){let o=n.filesNameAsStart,s=n.filesName,u=o.filter(function(n){return!s.includes(n)}),f=s.filter(function(n){return!o.includes(n)}),h=$.map(n.myuploadEle.myfiles,function(n){return n.name}),e=h.filter(function(n){return!f.includes(n)});e.length&&(u=u.concat(e),f=f.concat(e));let t=n.filesAsStart.filter(function(n){return u.indexOf(n.name)>-1}),r=n._files.filter(function(n){return h.indexOf(n.name)>-1}),c=n._files,l=function(){if(t.length)for(i=0;i<t.length;i++)t[i].event="delete";if(r.length)for(i=0;i<r.length;i++)r[i].event="new";return t.concat(r)}();return{deletedfilesname:u,newfilesname:f,deletedfiles:t,newfiles:r,currentfiles:c,logs:l}}}};$.fn.excelimport=function(n){n||(n={});n.onsuccess||(n.onsuccess=$.noop);n.onerror||(n.onerror=$.noop);n.imported||(n.imported="");n.casttostring===undefined&&(n.casttostring=!0);window.JSZip||oak.ajaxget({url:SV.host+SV.DependencyRootPath+"JSZip/jszip.min.js",async:!1,ajaxconfig:{datatype:"script"}});oak.excelimport.core(n)};oak.excelimport.core=function(n){let t=function(){this.args=n;this.clearRefer();this.createFileInputer();this.createDialog();this.Launching()};t.prototype={clearRefer:function(){window.excelimport||(window.excelimport={});window.excelimport.fileInput&&(window.excelimport.fileInput.value="");window.excelimport.args=this.args},createFileInputer:function(){if(!window.excelimport.createFileInputer){let n=document.createElement("input");n.type="file";n.style.display="none";n.accept=",.xls,.xlsx,.csv";n.addEventListener("change",this.onChange);document.body.appendChild(n);window.excelimport.fileInput=n;window.excelimport.createFileInputer=!0}},createDialog:function(){if(!window.excelimport.createDialog){let i=document.createElement("div"),n=document.createElement("select"),t=document.createElement("div");t.innerHTML="เลือก Sheet ที่ต้องการ";t.classList.add("mb10");t.style.fontSize=".8em";t.style.color="var(--error-c)";i.classList.add("p10");n.classList.add("select-2");n.style.width="350px";$(n).on("change",function(){window.excelimport.dialogChooseSheet.dialog("hide");window.excelimport.args.sheet=this.value;let n=document.createEvent("HTMLEvents");n.initEvent("change",!1,!0);window.excelimport.fileInput.dispatchEvent(n);window.excelimport.fileInput.value=""});i.appendChild(t);i.appendChild(n);window.excelimport.dialogChooseSheet=$(i).dialog({show:!1});window.excelimport.selectChooseSheet=$(n);window.excelimport.setDialogContent=this.setDialogContent;window.excelimport.getExcelSheets=this.getExcelSheets;window.excelimport.createDialog=!0}},setDialogContent:function(n){window.excelimport.selectChooseSheet.dropdown({source:n,placeholder:oakdef.excelimport_choose_sheet_msg,fixposition:!0});window.excelimport.dialogChooseSheet.dialog("show")},getExcelSheets:function(n,t){return new Promise(function(i){if(t)return i([t]);if(n.name.toLowerCase().indexOf(".xlsx")===0)return i([]);let r=[],u,f=new JSZip;f.loadAsync(n,{base64:!0}).then(function(n){let t=n.file("xl/workbook.xml");if(!t)return i([]);t.async("string").then(function(n){for(u=n.split("name="),sheet=1;sheet<u.length;sheet++){let n=u[sheet].split(" sheetId")[0].replace(/["']/g,"");r.push(n)}return i(r)}).catch(function(){return i(r)})})})},onChange:function(){let n=window.excelimport.args,t;if(!this.value)return!1;if(this.files&&this.files[0])t=this.files[0];else return!1;window.excelimport.getExcelSheets(t,n.sheet).then(function(i){if(i.constructor===Array)if(i.length===0)n.sheet="";else{if(i=i.filter(function(n){if(!n.includes("<\/"))return n}),i.length>1)return window.excelimport.setDialogContent(i);n.sheet=i[0]}let r=new FormData;r.append("filename",t.name);r.append("excelsheetname",n.sheet||n.excelsheetname);r.append("casttostring",n.casttostring);r.append("file",t);$.ajax({type:"post",url:SV.host+n.importto,processData:!1,contentType:!1,data:r,success:n.onsuccess||$.noop,error:n.onerror||$.noop})})},Launching:function(){window.excelimport.fileInput.click()}};new t};$.fn.emailing=function(n){n.Emailingfn=!0;let t=function(n){if(!n)return"";if(n[0]&&typeof n[0]=="object"){let r=Object.keys(n[0])[0],t=[];for(i=0;i<n.length;i++)t.push(n[i][r]);return t+""}return n+=""};n.config&&n.config.emailto&&(n.config.emailto=t(n.config.emailto));n.config&&n.config.emailcc&&(n.config.emailcc=t(n.config.emailcc));oak.ajaxpost(n)};$.fn.browser=function(){var i=navigator.userAgent,t,n=i.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(i)||[],{name:"IE",version:t[1]||""}):n[1]==="Chrome"&&(t=i.match(/\bOPR\/(\d+)/),t!==null)?{name:"Opera",version:t[1]}:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],(t=i.match(/version\/(\d+)/i))!==null&&n.splice(1,1,t[1]),{name:n[0],version:n[1]})};$.fn.datebox=function(n){if(this[0].dataset.layout&&this[0].dataset.layout==="inline")return this.dateboxinline(n);oak.datepicker||(oak.ajaxget({url:SV.host+SV.DependencyRootPath+"Bootstrap-Datepicker/bootstrap-datepicker.oak.min.js",async:!1,ajaxconfig:{datatype:"script"}}),$(document).off(".datepicker.data-api"));n||(n={});this[0].dataset.startview?n.startview=this[0].dataset.startview:n.startview||(n.startview=0);isNaN(n.startview)||(n.startview=parseInt(n.startview));let t={};if(n.defaultViewDate)t=n.defaultViewDate;else{let n=getDate();t.day=n.date;t.month=n.month;t.year=n.year}return this[0].type="text",this[0].autocomplete="off",this.datepicker({daysOfWeekHighlighted:[0,6],todayBtn:!0,todayHighlight:!0,format:"dd/mm/yyyy",language:"th",autoclose:!0,weekStart:1,thaiyear:!0,startView:n.startview})};$.fn.dateboxinline=function(){this[0].type="text";this[0].autocomplete="off";this[0].addEventListener("keydown",function(n){if([8,9,37,39].indexOf(n.which)>-1)return!0;(isNaN(n.key)||this.value.length===10)&&n.preventDefault()});this[0].addEventListener("keyup",function(n){if(this.value.length===2&&n.which!==8)this.value+="/";else if(this.value.length===5&&n.which!==8)this.value+="/";else if(this.value.length>=10){let n=0,i=oakdef.isBE?500:0,t=this.value.split("/");t[0]>31&&(n=1);t[1]>12&&(n=1);t[2]<1800+i&&(n=1);t[2]>2200+i&&(n=1);n===1&&this.value.length?(this.classList.add("error_msg"),this.iserror=1):(this.classList.remove("error_msg"),this.iserror=0)}});this[0].addEventListener("focusout",function(){if(this.value.length===8||this.value.length===9){let n=this.value.split("/");n[0].length===1&&n[0]>0&&(n[0]="0"+n[0]);n[1].length===1&&n[1]>0&&(n[1]="0"+n[1]);this.value=n[0]+"/"+n[1]+"/"+n[2]}this.value.length>0&&this.value.length!=10?this.classList.add("error_msg"):this.iserror?this.classList.add("error_msg"):this.classList.remove("error_msg")})};$.fn.refer=function(n,t){return t===undefined?this[0][n]:(this[0][n]=t instanceof jQuery?t[0]:t,this)};$.fn.referTo=function(n,t){return t[0]?t[0][n]=this[0]:t[n]=this[0],this};$.fn.dialog=function(n){let t=this,i=function(){this.get_Bootstrap_modal();this.args=n||{};this.me=t;this.dataset=this.me[0].dataset;this.validate_parameters();this.construction()};return i.prototype={validate_parameters:function(){if(typeof this.args=="string"){this.modal_string_method();return}this.draggable=this.dataset.draggable!==undefined?this.dataset.draggable:this.me.draggable===!0?!0:this.args.draggable===undefined?!0:this.args.draggable;this.backdrop=this.dataset.backdrop!==undefined?this.dataset.backdrop:this.args.backdrop!==undefined?this.args.backdrop:!1;this.args.show!==undefined?this.show=this.args.show==="toggle"?(this.me[0].dataset.show="true")?!1:!0:this.args.show:this.show===undefined&&(this.show=!1);this.position=this.args.position?this.args.position:{x:"center",y:"top",margin_top:"50"};this.draggable==="true"&&(this.draggable=!0);this.draggable==="false"&&(this.draggable=!1);this.backdrop==="true"&&(this.backdrop=!0);this.backdrop==="false"&&(this.backdrop=!1);this.title=this.args.title||this.me[0].title||""},get_Bootstrap_modal:function(){oak.modal||oak.ajaxget({url:SV.host+SV.DependencyRootPath+"/Modal/modal.min.js",async:!1,ajaxconfig:{datatype:"script"}})},modal_string_method:function(){if(this.args==="open"?this.args="show":this.args==="close"&&(this.args="hide"),this.args==="dispose"){let n=$(this.me[0].my_outline);n.modal("hide");n.modal("dispose");n.remove()}else $(this.me[0].my_outline).modal(this.args)},outline_create:function(){let n=document.createElement("div");return n.classList.add("modal"),n.classList.add(this.args.effect||oakdef.dialog_effect),n},outline_position:function(){outline=this.me[0].my_outline;let n=this.position.x,t=this.position.y,r=this.position.margin_top,u=this.position.margin_bottom,f=this.position.margin_left,e=this.position.margin_right,o=document.documentElement.clientWidth,s=document.documentElement.clientHeight,i=outline.getBoundingClientRect();if(isNaN(n)||(n=parseInt(n)),isNaN(t)||(t=parseInt(t)),this.position.at){let r=oak.pureHtml(this.position.at),i=r.getBoundingClientRect();n=i.left;t=i.top}n==="left"?n=0:n==="center"?n=o/2-i.width/2:n==="right"&&(n=o-i.width);t==="top"?t=0:t==="center"?t=s/2-i.height/2:t==="bottom"&&(t=s-i.height);f?n+=parseInt(f):e&&(n-=parseInt(e));r?t+=parseInt(r):u&&(t-=parseInt(u));scollheight=window.pageYOffset||document.documentElement.scrollTop;outline.style.left=n+"px";outline.style.top=t+scollheight+"px"},dialog_create:function(){return document.createElement("div")},content_create:function(){let n=document.createElement("div");return n.classList.add("modal-content"),n.style.display=" table-cell",n},header_create:function(){let t=document.createElement("div");t.classList.add("modal-header");let i=document.createElement("h3");i.classList.add("modal-title");i.innerHTML=this.title;let n=document.createElement("input");return n.type="button",n.classList.add("close"),n.setAttribute("data-dismiss","modal"),n.style.cursor="pointer",t.appendChild(i),t.appendChild(n),t},body_create:function(){let n=document.createElement("div");return n.classList.add("modal-body"),n},me_prepare:function(){this.me[0].alreadyhandle=!0;this.me[0].style.display=null;this.me[0].dataset.draggable=this.draggable;this.me[0].dataset.backdrop=this.backdrop;this.me[0].dataset.show=this.show;this.me[0].outline_position=this.outline_position},me_modal:function(n){let t=$(n);t.modal({show:this.show,backdrop:this.backdrop});this.draggable&&t.drag({drawer:n.drawer})},construction:function(){if(typeof this.args!="string"){if(!this.me[0].alreadyhandle){let i=this.body_create();i.appendChild(this.me[0]);let r=this.header_create(),n=this.content_create();n.appendChild(r);n.appendChild(i);let u=this.dialog_create();u.appendChild(n);let t=this.outline_create();t.drawer=r;t.appendChild(u);this.me[0].my_outline=t}this.me_prepare();this.me_modal(this.me[0].my_outline);this.outline_position()}}},new i,t};$.fn.drag=function(n){if(n.drawer&&!n.drawer.drag_added){let i;i=n.dragged?oak.pureHtml(n.dragged):this[0];let t=n.drawer;return t.my_target=i,t.draggable=!0,t.drag_added=!0,t.style.cursor="move",t.origin_transitionDuration=t.style.transitionDuration,t.addEventListener("mousedown",function(n){let t=this.getBoundingClientRect();this.rect_h=t.height;this.rect_w=t.width;this.posi_y=t.top+t.height-n.pageY;this.posi_x=t.left+t.width-n.pageX;this.my_target.classList.add("move")}),t.addEventListener("drag",function(n){if(!(n.pageY<1)&&!(n.pageX<1)){let t=window.pageYOffset||document.documentElement.scrollTop;this.my_target.style.top=t+n.pageY+this.posi_y-this.rect_h+"px";this.my_target.style.left=n.pageX+this.posi_x-this.rect_w+"px"}}),t.addEventListener("dragend",function(){this.my_target.classList.remove("move")}),t.addEventListener("mouseup",function(){this.my_target.classList.remove("move")}),$(i)}};$.fn.pureHtml=function(n){return n?typeof n=="string"?$(n)[0]:n instanceof jQuery?n[0]:n:undefined};$.fn.confirm=function(n){if(n&&n.buttons){let t,u="ยืนยัน",f="ยกเลิก";n.position||(n.position={},n.position.at=this);!n.position||n.position.x&&n.position.y||(n.position.at=this);!n.buttons instanceof Array?t.push(n.buttons):t=n.buttons;let r=document.createElement("div");for(r.classList.add("p5"),i=0;i<t.length;i++){let n=document.createElement("input");if(t[i].css){let r=t[i].css.split(" ");for(a=0;a<r.length;a++)n.classList.add(r[a])}i<t.length-1&&n.classList.add("mr5");n.type="button";n.value=t[i].text;n.clickEvent=t[i].onclick;n.onclick=function(){this.clickEvent&&this.clickEvent();$(r).dialog("dispose")};i!==0||n.text?i!==1||n.text||(n.text=f):n.text=u;r.appendChild(n)}$(r).dialog({show:!0,backdrop:n.backdrop||!0,title:n.title||"",position:n.position,draggable:n.draggable||!1,effect:"modal-fadein"})}};$.fn.processingButton=function(n,t){let u=[],f={yellow:"rgba(255, 242, 5, 0.8)",green:"rgb(8, 86, 105)",purple:"#3d2ca8",blue:"#253e85",ILPYellow:"#cace21"},s=oakdef.processingButton_value,e=n.loadingtime||oakdef.processingButton_loadingTime,o=oakdef.processingButton_timeOut,r="";n===!1||n=="visible"?(t=!0,n={}):n===undefined&&(n={});this[0]instanceof HTMLElement&&u.push(this[0]);n.elements&&u.concat(n.elements);n.value===undefined&&(n.value=!0);r=n.color?n.color:n.theme!==undefined?f[n.theme]:f[oakdef.processingButton_theme];n.timeout&&(o=n.timeout);let h=function(n){if(n.LoadingCssClassIsExists)return n.classList.add(n.LoadingCssClassName);let o=n.id||Math.random().toString(36).substring(7),t=n.getBoundingClientRect().width,s="keyframeOf_"+o,i="calleOf_"+o,u=document.createElement("style");u.type="text/css";u.innerHTML="@keyframes "+s+" { 0% {box-shadow: inset 0 0 0 0 "+r+";} 60% {box-shadow: inset  "+t+"px 0 0 1px "+r+";}80% {box-shadow: inset  "+t+"px 0 0 1px "+r+";}100% {box-shadow: inset  0 "+t+"px 0 0 0 "+r+";}} ";let f=document.createElement("style");f.type="text/css";f.innerHTML="."+i+"{animation:"+s+" "+e/1e3+"s infinite}";document.getElementsByTagName("head")[0].appendChild(f);document.getElementsByTagName("head")[0].appendChild(u);n.LoadingCssClassIsExists=!0;n.LoadingCssClassName=i;n.classList.add(i)},c=function(n){callerName=n.LoadingCssClassName;n.classList.remove(callerName)};for(i=0;i<u.length;i++){let r=oak.pureHtml(u[i]);t?(r.valueOrigin&&(r.value=r.valueOrigin),r.disabled=!1,r.style.pointerEvents="visible",c(r)):(r.valueOrigin=r.value,r.disabled=!0,r.style.pointerEvents="none",n.value&&(r.value=n.value==!0?s:n.value),e&&h(r),window.setTimeout(function(){$(r).processingButton(!1)},o))}return this};$.fn.progressbar=function(n){n=n===undefined?{}:n;var t=this[0];$.fn.progressbar.prototype.ele=this[0];this.createBar=function(){if(!t.dataset.createdbar){var i=document.createElement("div");i.style.width="0%";i.style.height=n.height||"6px";i.style.background=n.background||"#0096A9";i.style.position="absolute";i.style.transition=".5s width";t.appendChild(i);t.dataset.createdbar=!0;t.style.zIndex=999;t.mybar=i}};this.move=function(){t.mybar.style.width==="0%"&&(t.mybar.style.display="",window.setTimeout(function(){t.mybar.style.width="60%"},100))};$.fn.progressbar.prototype.ele=t;this.createBar();this.move()};$.fn.progressbar.clear=function(){var n=$.fn.progressbar.prototype.ele;n.mybar&&(window.setTimeout(function(){n.mybar.style.width="100%"},400),window.setTimeout(function(){$(n.mybar).fadeOut(300)},800),window.setTimeout(function(){n.mybar.style.width="0%"},1100))};$.fn.activemenu=function(n){if((n||(n={}),this instanceof Array&&this instanceof jQuery&&(n.container=this[0]),!n.buttons)||(n.buttonsHTML=n.container?this.find($(n.buttons)):$(n.buttons),n.buttonsHTML.length===0))return this;for(n.activecss||(n.activecss=""),n.inactivecss||(n.inactivecss=""),n.allMyContainers=[],i=0;i<n.buttonsHTML.length;i++)n.buttonsHTML[i].dataset.mycontainer&&n.allMyContainers.push(n.buttonsHTML[i].dataset.mycontainer);var r=function(){if($(this.myMember).removeClass(this.activecss),$(this).addClass(this.activecss),this.inactivecss&&($(this.myMember).addClass(this.inactivecss),$(this).removeClass(this.inactivecss)),this.allMyContainers&&this.dataset.mycontainer){var t=this.dataset.mycontainer,r=this.allMyContainers.filter(function(n){return n!==t});for($(t).slideDown(),i=0;i<r.length;i++)$(r[i]).slideUp()}if(n.onclick)n.onclick(this)},t=null,u=function(t){if(t)for(t=t.toLowerCase(),n.buttonsHTML.hide(),i=0;i<n.buttonsHTML.length;i++)t==="fadein"?$(n.buttonsHTML[i]).delay(i*300).fadeIn():t==="slidedown"&&$(n.buttonsHTML[i]).delay(i*300).slideDown()};for(n.starteffect&&u(n.starteffect),i=0;i<n.buttonsHTML.length;i++)n.buttonsHTML[i].myMember=n.buttonsHTML,n.buttonsHTML[i].activecss=n.activecss,n.buttonsHTML[i].inactivecss=n.inactivecss,n.buttonsHTML[i].addEventListener("click",r),n.allMyContainers.length&&(n.buttonsHTML[i].allMyContainers=n.allMyContainers),n.buttonsHTML[i].dataset.defaultContainer&&(t=n.buttonsHTML[i]);t&&$(t).trigger("click")};$.checkboxesSetup=function(n){oakdef.checkboxesSetup===undefined&&(oakdef.checkboxesSetup={});$.extend(oakdef.checkboxesSetup,n)};$.fn.checkboxes=function(n){oakdef.checkboxesSetup===undefined&&(oakdef.checkboxesSetup={});var t=oakdef.checkboxesSetup;if(typeof n=="string"&&n==="get")return oak.checkboxes.get(this[0]);if(n.me=this[0],n.me.innerHTML="",n.createFor=this.type&&this.type==="checkbox"?"checkbox":"nonCheckbox",n.createFor==="nonCheckbox"&&(!n.source||!n.source.length))return!1;n.chekedcolor=n.chekedcolor||t.chekedcolor||"#1097a9";n.unchekedcolor=n.unchekedcolor||t.unchekedcolor||"#f1f1f1";n.fontsize=n.fontsize||t.fontsize||"1rem";n.checkboxsize=n.checkboxsize||t.checkboxsize||"1.6rem";n.flexdirection=n.flexdirection||t.flexdirection||"row";n.onchange||(n.onchange=$.noop);oak.checkboxes.core(n)};oak.checkboxes.core=function(n){var t=function(){this.cssContainer="chkes";this.cssCheckMark="checkmark";this.chekedcolor=n.chekedcolor;this.unchekedcolor=n.unchekedcolor;this.fontsize=n.fontsize;this.checkboxsize=n.checkboxsize;this.flexdirection=n.flexdirection;this.onchange=n.onchange;this.setflexdirection(n.me);this.build=function(){for(i=0;i<n.source.length;i++){var r=n.source[i],t=this.createContainer(r),u=this.createCheckmark(),f=this.createLabel(r);t.appendChild(u);t.appendChild(f);t.myCheckmark=u;this.systemChangeEvent(t);n.me.appendChild(t)}};this.build()};t.prototype={createContainer:function(t){var r=this.onchange,i=document.createElement("div"),u=this.systemChangeEvent;return i.classList.add(this.cssContainer),i.myCheckedColor=this.chekedcolor,i.myUnCheckedColor=this.unchekedcolor,i.checked=t.checked,i.myvalue=t.value,i.mytext=t.text,i.addEventListener("click",function(){u(this,!0);r(this)}),n.me.style.flexDirection==="row"&&(i.style.marginRight="1rem"),i},createLabel:function(n){var t=document.createElement("label");return t.innerHTML=n.text,t.style.fontSize=this.fontsize,t},createCheckmark:function(){var n=document.createElement("span");return n.classList.add(this.cssCheckMark),n.style.background=this.unchekedcolor,n.style.width=this.checkboxsize,n.style.height=this.checkboxsize,n.style.fontSize=this.fontsize,n},setflexdirection:function(n){n.style.display="flex";n.style.flexDirection=this.flexdirection},systemChangeEvent:function(n,t){!n.checked&&t||n.checked&&!t?(n.myCheckmark.style.background=n.myCheckedColor,n.myCheckmark.innerText="/",n.myCheckmark.classList.add("checked"),n.checked=!0):(n.myCheckmark.style.background=n.myUnCheckedColor,n.myCheckmark.innerText="",n.myCheckmark.classList.remove("checked"),n.checked=!1)}};n.createFor==="nonCheckbox"&&new t};oak.checkboxes.get=function(n){var t={all:[],checked:[],unchecked:[]};return $(n).children(".chkes").each(function(){t.all.push({text:this.mytext,value:this.myvalue,checked:this.checked})}),t.checked=t.all.filter(function(n){return n.checked===!0}),t.unchecked=t.all.filter(function(n){return n.checked===!1}),t};JSON.combineSchemeAndData=function(n){var r,t;if(!n||n instanceof Array||!n.Data||!n.Schema)return n;for(r=n.Schema[0],i=0;i<n.Data.length;i++){for(t in n.Data[i])Object.defineProperty(n.Data[i],r[t],Object.getOwnPropertyDescriptor(n.Data[i],t));for(t in r)delete n.Data[i][t]}};